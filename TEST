import os
import requests
import feedparser
import pdfkit

# Make sure the PDFkit path is set
path_wkhtmltopdf = r'/usr/local/bin/wkhtmltopdf'
config = pdfkit.configuration(wkhtmltopdf=path_wkhtmltopdf)

# Create directory to store PDFs if it doesn't already exist
if not os.path.exists('pdfs'):
    os.makedirs('pdfs')

# Fetch the RSS feed
feed = feedparser.parse('https://www.federalreserve.gov/feeds/press_all.xml')

# For each post in the feed
for post in feed.entries:
    # Download the HTML of the post
    html = requests.get(post.link).text
    
    # Convert the HTML to PDF
    pdf = pdfkit.from_string(html, False, configuration=config)
    
    # Create a filename based on the post's title
    filename = post.title.replace(' ', '_') + '.pdf'
    
    # Save the PDF to a file
    with open('pdfs/' + filename, 'wb') as f:
        f.write(pdf)
